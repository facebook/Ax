language: python

python:
  - 3.6

before_install:
  # decrypting ssh key to be able to access private botorch repo
  - openssl aes-256-cbc -K $encrypted_39ecd60da1dc_key -iv $encrypted_39ecd60da1dc_iv -in botorch_key.enc -out botorch_key -d
  - chmod 600 botorch_key
  - eval "$(ssh-agent -s)"
  - ssh-add botorch_key


# Enable Python 3.7 w/o without globally enabling sudo and xenial dist
# See https://github.com/travis-ci/travis-ci/issues/9815
matrix:
  include:
      - name: "Python 3.6 with GPy"
        python: "3.6"
        dist: xenial
        install:
            - pip install cython numpy
            - pip install git+ssh://git@github.com/facebookexternal/botorch.git
            - pip install -q -e .[dev,mysql,notebook,gpy]
        script:
          - black --check --diff .
          - flake8 --ignore=A000,T484,T499,W503,E704,E231,E203
          - pytest -ra
      - name: "Python 3.7"
        python: "3.7"
        dist: xenial
        install:
            - pip install cython numpy
            - pip install git+ssh://git@github.com/facebookexternal/botorch.git
            - pip install -q -e .[dev,mysql,notebook]
        script:
          - black --check --diff .
          - flake8 --ignore=A000,T484,T499,W503,E704,E231,E203
          - pytest -ra  --ignore=ax/models/tests/test_gpy.py   --ignore=ax/models/tests/test_gpy_nei.py
