language: python

python:
  - 3.6

before_install:
  # decrypting ssh key to be able to access private botorch repo
  - openssl aes-256-cbc -K $encrypted_39ecd60da1dc_key -iv $encrypted_39ecd60da1dc_iv -in botorch_key.enc -out botorch_key -d
  - chmod 600 botorch_key
  - eval "$(ssh-agent -s)"
  - ssh-add botorch_key

install:
  # install cython and numpy first as they are needed for botorch / Ax setup.py files
  - pip install cython numpy
  - pip install git+ssh://git@github.com/facebookexternal/botorch.git
  - pip install -q -e .[dev,mysql,notebook]

# Enable Python 3.7 w/o without globally enabling sudo and xenial dist
# See https://github.com/travis-ci/travis-ci/issues/9815
matrix:
  include:
    # Cannot build on 3.7 because of GPy; see https://github.com/SheffieldML/GPy/issues/649
    # - python: 3.7
    #   dist: xenial
    #   sudo: true
    - python: 3.6

script:
  - black --check --diff .
  - flake8
  - pytest -ra
