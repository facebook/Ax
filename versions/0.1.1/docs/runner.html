<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Runner · Ax</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;h2&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;function-evaluation-in-ax&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#function-evaluation-in-ax&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Function Evaluation in Ax&lt;/h2&gt;
"/><meta name="docsearch:version" content="0.1.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Runner · Ax"/><meta property="og:type" content="website"/><meta property="og:url" content="https://ax.dev//versions/0.1.1/index.html"/><meta property="og:description" content="&lt;h2&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;function-evaluation-in-ax&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#function-evaluation-in-ax&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Function Evaluation in Ax&lt;/h2&gt;
"/><meta property="og:image" content="https://ax.dev//versions/0.1.1/img/ax.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://ax.dev//versions/0.1.1/img/ax.svg"/><link rel="shortcut icon" href="/versions/0.1.1/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://cdn.plot.ly/plotly-latest.min.js"></script><script type="text/javascript" src="/versions/0.1.1/js/plotUtils.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/versions/0.1.1/js/mathjax.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><link rel="stylesheet" href="/versions/0.1.1/css/main.css"/><script src="/versions/0.1.1/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/versions/0.1.1/"><img class="logo" src="/versions/0.1.1/img/ax_lockup_white.svg" alt="Ax"/><h2 class="headerTitleWithLogo">Ax</h2></a><a href="/versions/0.1.1/versions.html"><h3>0.1.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/versions/0.1.1/docs/why-ax.html" target="_self">Docs</a></li><li class=""><a href="/versions/0.1.1/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/versions/0.1.1/api/" target="_self">API</a></li><li class=""><a href="https://github.com/facebook/Ax" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Components</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/why-ax.html">Why Ax?</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/api.html">APIs</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/glossary.html">Glossary</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Algorithms</h3><ul class=""><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/bayesopt.html">Bayesian Optimization</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/banditopt.html">Bandit Optimization</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Components</h3><ul class=""><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/core.html">Core</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/versions/0.1.1/docs/runner.html">Runner</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/data.html">Data</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/models.html">Models</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.1/docs/storage.html">Storage</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Runner</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="function-evaluation-in-ax"></a><a href="#function-evaluation-in-ax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Function Evaluation in Ax</h2>
<p>There are 3 paradigms for evaluating <a href="/versions/0.1.1/docs/glossary.html#trial">trials</a>:</p>
<h3><a class="anchor" aria-hidden="true" id="synchronous"></a><a href="#synchronous" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Synchronous</h3>
<p>In the synchronous paradigm, the user specifies an evaluation function which takes in parameters and outputs metric outcomes. This use case is supported by the <a href="/api/core.html#module-ax.core.simple_experiment"><code>SimpleExperiment</code></a> class:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> ax <span class="hljs-keyword">import</span> *

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dummy_evaluation_function</span><span class="hljs-params">(
    parameterization, # dict of parameter names to values of those parameters
    weight=None, # optional outcome weight argument
)</span>:</span>
    <span class="hljs-comment"># given parameterization, compute a value for each metric</span>
    x = parameterization[<span class="hljs-string">"x"</span>]
    y = parameterization[<span class="hljs-string">"y"</span>]
    objective_val = f(x, y)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"objective"</span>: objective_val}

exp = SimpleExperiment(
    name=<span class="hljs-string">"simple_experiment"</span>,
    search_space=SearchSpace(
      parameters=[
        RangeParameter(name=<span class="hljs-string">"x"</span>, lower=<span class="hljs-number">0.0</span>, upper=<span class="hljs-number">1.0</span>, parameter_type=ParameterType.FLOAT),
        RangeParameter(name=<span class="hljs-string">"y"</span>, lower=<span class="hljs-number">0.0</span>, upper=<span class="hljs-number">1.0</span>, parameter_type=ParameterType.FLOAT),
      ]
    ),
    evaluation_function=dummy_evaluation_function,
    objective_name=<span class="hljs-string">"objective"</span>,
)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="asynchronous"></a><a href="#asynchronous" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Asynchronous</h3>
<p>In the asynchronous paradigm, the trial is first deployed and the data is fetched at a later time. This is useful when evaluation happens on an external system and takes a long time to complete, such as for A/B tests. This is supported by the <a href="/api/core.html#module-ax.core.experiment"><code>Experiment</code></a> class. In this paradigm, the user specifies:</p>
<ul>
<li><a href="../api/core.html#ax.core.runner.Runner"><code>Runner</code></a>: Defines how to deploy the experiment.</li>
<li>List of <a href="../api/core.html#ax.core.metric.Metric"><code>Metrics</code></a>: Each defining how to compute/fetch data for a given metric.</li>
</ul>
<p>A default runner is specified on the experiment, which is attached to each trial right before deployment. Runners can also be manually added to a trial to override the experiment default.</p>
<h3><a class="anchor" aria-hidden="true" id="service-like"></a><a href="#service-like" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Service-like</h3>
<p>It is also possible to use Ax in a service-like manner, where Ax just suggests
<a href="/versions/0.1.1/docs/glossary.html#arm">Arms</a>, which the client application evaluates and logs the results
back to Ax. In this case, no runner or evaluation function is needed,
since the evaluation is done on the client side. For more information,
refer to <a href="/api/core.html#module-ax.service"><code>Service</code></a> module
reference and the <a href="/versions/0.1.1/docs/api.html">API docs</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="adding-your-own-runner"></a><a href="#adding-your-own-runner" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding Your Own Runner</h2>
<p>To add your own runner, subclass <a href="../api/core.html#ax.core.runner.Runner"><code>Runner</code></a> and implement the <a href="../api/core.html#ax.core.runner.Runner.run"><code>run</code></a> method and <a href="../api/core.html#ax.core.runner.Runner.staging_required"><code>staging_required</code></a> property.</p>
<p>The <a href="../api/core.html#ax.core.runner.Runner.run"><code>run</code></a> method accepts a Trial and returns a JSON-serializable dictionary of any necessary tracking info to fetch data later from this external system. A unique identifier or name for this trial in the external system should be stored in this dictionary with the key &quot;name&quot;, can then be accessed via trial.deployed_name.</p>
<p>The <a href="../api/core.html#ax.core.runner.Runner.staging_required"><code>staging_required</code></a> indicates whether the trial requires an intermediate staging period before evaluation begins. This property returns False by default.</p>
<p>An example implementation is given below:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> foo_system <span class="hljs-keyword">import</span> deploy_to_foo
<span class="hljs-keyword">from</span> ax <span class="hljs-keyword">import</span> Runner

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooRunner</span><span class="hljs-params">(Runner)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, foo_param)</span>:</span>
        self.foo_param = foo_param

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span><span class="hljs-params">(self, trial)</span>:</span>
        name_to_params = {
            arm.name: arm.params <span class="hljs-keyword">for</span> arm <span class="hljs-keyword">in</span> trial.arms
        }
        run_metadata = deploy_to_foo(foo_param, name_to_params)
        <span class="hljs-keyword">return</span> run_metadata

<span class="hljs-meta">    @property</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">staging_required</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<p>This is then invoked by calling:</p>
<pre><code class="hljs css language-python">exp = Experiment(...)
exp.runner = FooRunner(foo_param=<span class="hljs-string">"foo"</span>)
trial = exp.new_batch_trial()

<span class="hljs-comment"># This calls runner's run method and stores metadata output</span>
<span class="hljs-comment"># in the trial.run_metadata field</span>
trial.run()
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/versions/0.1.1/docs/core.html"><span class="arrow-prev">← </span><span>Core</span></a><a class="docs-next button" href="/versions/0.1.1/docs/data.html"><span>Data</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#function-evaluation-in-ax">Function Evaluation in Ax</a><ul class="toc-headings"><li><a href="#synchronous">Synchronous</a></li><li><a href="#asynchronous">Asynchronous</a></li><li><a href="#service-like">Service-like</a></li></ul></li><li><a href="#adding-your-own-runner">Adding Your Own Runner</a></li></ul></nav></div><footer class="nav-footer" id="footer"><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/versions/0.1.1/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 Facebook Inc.</section></footer></div></body></html>