<!DOCTYPE html><html lang=""><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Ax · Adaptive Experimentation Platform</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Adaptive Experimentation Platform"/><meta property="og:title" content="Ax · Adaptive Experimentation Platform"/><meta property="og:type" content="website"/><meta property="og:url" content="https://ax.dev//versions/0.1.5/index.html"/><meta property="og:description" content="Adaptive Experimentation Platform"/><meta property="og:image" content="https://ax.dev//versions/0.1.5/img/ax.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://ax.dev//versions/0.1.5/img/ax.svg"/><link rel="shortcut icon" href="/versions/0.1.5/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-139570076-1', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://cdn.plot.ly/plotly-latest.min.js"></script><script type="text/javascript" src="/versions/0.1.5/js/plotUtils.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/versions/0.1.5/js/mathjax.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/versions/0.1.5/js/scrollSpy.js"></script><link rel="stylesheet" href="/versions/0.1.5/css/main.css"/><script src="/versions/0.1.5/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/versions/0.1.5/"><img class="logo" src="/versions/0.1.5/img/ax_lockup_white.svg" alt="Ax"/><h2 class="headerTitleWithLogo">Ax</h2></a><a href="/versions/0.1.5/versions.html"><h3>0.1.5</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/versions/0.1.5/docs/why-ax.html" target="_self">Docs</a></li><li class=""><a href="/versions/0.1.5/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/versions/0.1.5/api/" target="_self">API</a></li><li class=""><a href="https://github.com/facebook/Ax" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span></span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/">Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Comparison</h3><ul class=""><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/gpei_hartmann_loop.html">Loop API</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/gpei_hartmann_service.html">Service API</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/gpei_hartmann_developer.html">Developer API</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Bayesian Optimization</h3><ul class=""><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/tune_cnn.html">Hyperparameter Optimization for PyTorch</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/multi_task.html">Multi-Task Modeling</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/benchmarking_suite_example.html">Benchmarking Suite</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Field Experiments</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/versions/0.1.5/tutorials/factorial.html">Bandit Optimization</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/human_in_the_loop/human_in_the_loop.html">Human-in-the-Loop Optimization</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Deep Dives</h3><ul class=""><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/building_blocks.html">Building Blocks of Ax</a></li><li class="navListItem"><a class="navItem" href="/versions/0.1.5/tutorials/visualizations.html">Visualizations</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="tutorialBody">
<script>
const requirejs = Object();
requirejs.config = function() { };

const dependencyMap = {
    'plotly': Plotly,
}

function require(deps, fxn) {
    return fxn(...deps.map(dep => dependencyMap[dep]));
};
</script>
<div class="notebook">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Factorial-design-with-empirical-Bayes-and-Thompson-Sampling">Factorial design with empirical Bayes and Thompson Sampling<a class="anchor-link" href="#Factorial-design-with-empirical-Bayes-and-Thompson-Sampling">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><markdowncell>
This tutorial illustrates how to run a factorial experiment. In such an experiment, each parameter (factor) can be assigned one of multiple discrete values (levels). A full-factorial experiment design explores all possible combinations of factors and levels.</markdowncell></p>
<p>For instance, consider a banner with a title and an image. We are considering two different titles and three different images. A full-factorial experiment will compare all 2*3=6 possible combinations of title and image, to see which version of the banner performs the best.</p>
<p>In this example, we first run an exploratory batch to collect data on all possible combinations. Then we use empirical Bayes to model the data and shrink noisy estimates toward the mean. Next, we use Thompson Sampling to suggest a set of arms (combinations of factors and levels) on which to collect more data. We repeat the process until we have identified the best performing combination(s).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sklearn</span> <span class="k">as</span> <span class="nn">skl</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">ax</span> <span class="k">import</span> <span class="n">Arm</span><span class="p">,</span> <span class="n">ChoiceParameter</span><span class="p">,</span> <span class="n">Models</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">,</span> <span class="n">SearchSpace</span><span class="p">,</span> <span class="n">SimpleExperiment</span>
<span class="kn">from</span> <span class="nn">ax.plot.scatter</span> <span class="k">import</span> <span class="n">plot_fitted</span>
<span class="kn">from</span> <span class="nn">ax.utils.notebook.plotting</span> <span class="k">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">init_notebook_plotting</span>
<span class="kn">from</span> <span class="nn">ax.utils.stats.statstools</span> <span class="k">import</span> <span class="n">agresti_coull_sem</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">init_notebook_plotting</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<script type="text/javascript">/*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

requirejs.config({
  paths: {
    plotly: ['https://cdn.plot.ly/plotly-latest.min'],
  },
});
if (!window.Plotly) {
  require(['plotly'], function(plotly) {
    window.Plotly = plotly;
  });
}
/*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

// helper functions used across multiple plots
function rgb(rgb_array) {
  return 'rgb(' + rgb_array.join() + ')';
}

function copy_and_reverse(arr) {
  const copy = arr.slice();
  copy.reverse();
  return copy;
}

function axis_range(grid, is_log) {
  return is_log
    ? [Math.log10(Math.min(...grid)), Math.log10(Math.max(...grid))]
    : [Math.min(...grid), Math.max(...grid)];
}

function relativize_data(f, sd, rel, arm_data, metric) {
  // if relative, extract status quo & compute ratio
  const f_final = rel === true ? [] : f;
  const sd_final = rel === true ? [] : sd;

  if (rel === true) {
    const f_sq =
      arm_data['in_sample'][arm_data['status_quo_name']]['y'][metric];
    const sd_sq =
      arm_data['in_sample'][arm_data['status_quo_name']]['se'][metric];

    for (let i = 0; i < f.length; i++) {
      res = relativize(f[i], sd[i], f_sq, sd_sq);
      f_final.push(100 * res[0]);
      sd_final.push(100 * res[1]);
    }
  }

  return [f_final, sd_final];
}

function relativize(m_t, sem_t, m_c, sem_c) {
  r_hat =
    (m_t - m_c) / Math.abs(m_c) -
    (Math.pow(sem_c, 2) * m_t) / Math.pow(Math.abs(m_c), 3);
  variance =
    (Math.pow(sem_t, 2) + Math.pow((m_t / m_c) * sem_c, 2)) / Math.pow(m_c, 2);
  return [r_hat, Math.sqrt(variance)];
}

function slice_config_to_trace(
  arm_data,
  arm_name_to_parameters,
  f,
  fit_data,
  grid,
  metric,
  param,
  rel,
  setx,
  sd,
  is_log,
  visible,
) {
  // format data
  const res = relativize_data(f, sd, rel, arm_data, metric);
  const f_final = res[0];
  const sd_final = res[1];

  // get data for standard deviation fill plot
  const sd_upper = [];
  const sd_lower = [];
  for (let i = 0; i < sd.length; i++) {
    sd_upper.push(f_final[i] + 2 * sd_final[i]);
    sd_lower.push(f_final[i] - 2 * sd_final[i]);
  }
  const grid_rev = copy_and_reverse(grid);
  const sd_lower_rev = copy_and_reverse(sd_lower);
  const sd_x = grid.concat(grid_rev);
  const sd_y = sd_upper.concat(sd_lower_rev);

  // get data for observed arms and error bars
  const arm_x = [];
  const arm_y = [];
  const arm_sem = [];
  fit_data.forEach(row => {
    parameters = arm_name_to_parameters[row['arm_name']];
    plot = true;
    Object.keys(setx).forEach(p => {
      if (p !== param && parameters[p] !== setx[p]) {
        plot = false;
      }
    });
    if (plot === true) {
      arm_x.push(parameters[param]);
      arm_y.push(row['mean']);
      arm_sem.push(row['sem']);
    }
  });

  const arm_res = relativize_data(arm_y, arm_sem, rel, arm_data, metric);
  const arm_y_final = arm_res[0];
  const arm_sem_final = arm_res[1].map(x => x * 2);

  // create traces
  const f_trace = {
    x: grid,
    y: f_final,
    showlegend: false,
    hoverinfo: 'x+y',
    line: {
      color: 'rgba(128, 177, 211, 1)',
    },
    visible: visible,
  };

  const arms_trace = {
    x: arm_x,
    y: arm_y_final,
    mode: 'markers',
    error_y: {
      type: 'data',
      array: arm_sem_final,
      visible: true,
      color: 'black',
    },
    line: {
      color: 'black',
    },
    showlegend: false,
    hoverinfo: 'x+y',
    visible: visible,
  };

  const sd_trace = {
    x: sd_x,
    y: sd_y,
    fill: 'toself',
    fillcolor: 'rgba(128, 177, 211, 0.2)',
    line: {
      color: 'transparent',
    },
    showlegend: false,
    hoverinfo: 'none',
    visible: visible,
  };

  traces = [sd_trace, f_trace, arms_trace];

  // iterate over out-of-sample arms
  let i = 1;
  Object.keys(arm_data['out_of_sample']).forEach(generator_run_name => {
    const ax = [];
    const ay = [];
    const asem = [];
    const atext = [];

    Object.keys(arm_data['out_of_sample'][generator_run_name]).forEach(
      arm_name => {
        const parameters =
          arm_data['out_of_sample'][generator_run_name][arm_name]['parameters'];
        plot = true;
        Object.keys(setx).forEach(p => {
          if (p !== param && parameters[p] !== setx[p]) {
            plot = false;
          }
        });
        if (plot === true) {
          ax.push(parameters[param]);
          ay.push(
            arm_data['out_of_sample'][generator_run_name][arm_name]['y_hat'][
              metric
            ],
          );
          asem.push(
            arm_data['out_of_sample'][generator_run_name][arm_name]['se_hat'][
              metric
            ],
          );
          atext.push('<em>Candidate ' + arm_name + '</em>');
        }
      },
    );

    const out_of_sample_arm_res = relativize_data(
      ay,
      asem,
      rel,
      arm_data,
      metric,
    );
    const ay_final = out_of_sample_arm_res[0];
    const asem_final = out_of_sample_arm_res[1].map(x => x * 2);

    traces.push({
      hoverinfo: 'text',
      legendgroup: generator_run_name,
      marker: {color: 'black', symbol: i, opacity: 0.5},
      mode: 'markers',
      error_y: {
        type: 'data',
        array: asem_final,
        visible: true,
        color: 'black',
      },
      name: generator_run_name,
      text: atext,
      type: 'scatter',
      xaxis: 'x',
      x: ax,
      yaxis: 'y',
      y: ay_final,
      visible: visible,
    });

    i += 1;
  });
  return traces;
}
</script>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>[INFO 08-29 13:21:29] ipy_plotting: Injecting Plotly library into cell. Do not overwrite or delete cell.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Define-the-search-space">1. Define the search space<a class="anchor-link" href="#1.-Define-the-search-space">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><markdowncell>
First, we define our search space. A factorial search space contains a ChoiceParameter for each factor, where the values of the parameter are its levels.</markdowncell></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">search_space</span> <span class="o">=</span> <span class="n">SearchSpace</span><span class="p">(</span>
    <span class="n">parameters</span><span class="o">=</span><span class="p">[</span>
        <span class="n">ChoiceParameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">"factor1"</span><span class="p">,</span>
            <span class="n">parameter_type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">STRING</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">"level11"</span><span class="p">,</span> <span class="s2">"level12"</span><span class="p">,</span> <span class="s2">"level13"</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="n">ChoiceParameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">"factor2"</span><span class="p">,</span>
            <span class="n">parameter_type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">STRING</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">"level21"</span><span class="p">,</span> <span class="s2">"level22"</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="n">ChoiceParameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">"factor3"</span><span class="p">,</span>
            <span class="n">parameter_type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">STRING</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">"level31"</span><span class="p">,</span> <span class="s2">"level32"</span><span class="p">,</span> <span class="s2">"level33"</span><span class="p">,</span> <span class="s2">"level34"</span><span class="p">],</span>
        <span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Define-the-evaluation-function">2. Define the evaluation function<a class="anchor-link" href="#2.-Define-the-evaluation-function">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><markdowncell>
Second, we define an evaluation function, which is responsible for computing
the mean and standard error of a given arm.</markdowncell></p>
<p>In this example, each possible parameter value is given a coefficient. The higher the level, the higher the coefficient, and the higher the coefficients, the greater the mean.</p>
<p>The standard error of each arm is determined by the weight passed into the evaluation function, which represents the size of the population on which this arm was evaluated. The higher the weight, the greater the sample size, and thus the lower the standard error.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">one_hot_encoder</span> <span class="o">=</span> <span class="n">skl</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">OneHotEncoder</span><span class="p">(</span>
    <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">search_space</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span> 
<span class="p">)</span>

<span class="k">def</span> <span class="nf">factorial_evaluation_function</span><span class="p">(</span>
    <span class="c1"># `parameterization` is a dict of parameter names to values of those parameters.</span>
    <span class="n">parameterization</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]],</span>
    <span class="c1"># `weight` is the weight of the parameterization, </span>
    <span class="c1"># which is used to determine the variance of the estimate.</span>
    <span class="n">weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>  <span class="c1"># Mapping of metric names to tuple of mean and standard error.</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">noise_level</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span> <span class="k">if</span> <span class="n">weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mf">1.0</span>
    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span>
        <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span>
    <span class="p">])</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">parameterization</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">encoded_features</span> <span class="o">=</span> <span class="n">one_hot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">coefficients</span> <span class="o">@</span> <span class="n">encoded_features</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_level</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
    <span class="n">plays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
    <span class="n">successes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">plays</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">successes</span><span class="p">)</span> <span class="o">/</span> <span class="n">plays</span>
    <span class="n">sem</span> <span class="o">=</span> <span class="n">agresti_coull_sem</span><span class="p">(</span><span class="n">successes</span><span class="p">,</span> <span class="n">plays</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">"success_metric"</span><span class="p">:</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sem</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Define-the-experiment">3. Define the experiment<a class="anchor-link" href="#3.-Define-the-experiment">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><markdowncell>
We now set up our experiment and define the status quo arm, in which each parameter is assigned to the lowest level.</markdowncell></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="n">SimpleExperiment</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">"my_factorial_closed_loop_experiment"</span><span class="p">,</span>
    <span class="n">search_space</span><span class="o">=</span><span class="n">search_space</span><span class="p">,</span>
    <span class="n">evaluation_function</span><span class="o">=</span><span class="n">factorial_evaluation_function</span><span class="p">,</span>
    <span class="n">objective_name</span><span class="o">=</span><span class="s2">"success_metric"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">status_quo</span> <span class="o">=</span> <span class="n">Arm</span><span class="p">(</span>
    <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">"factor1"</span><span class="p">:</span> <span class="s2">"level11"</span><span class="p">,</span> <span class="s2">"factor2"</span><span class="p">:</span> <span class="s2">"level21"</span><span class="p">,</span> <span class="s2">"factor3"</span><span class="p">:</span> <span class="s2">"level31"</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4.-Run-an-exploratory-batch">4. Run an exploratory batch<a class="anchor-link" href="#4.-Run-an-exploratory-batch">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><markdowncell>
We then generate an a set of arms that covers the full space of the factorial design, including the status quo. There are three parameters, with two, three, and four values, respectively, so there are 24 possible arms.</markdowncell></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">factorial</span> <span class="o">=</span> <span class="n">Models</span><span class="o">.</span><span class="n">FACTORIAL</span><span class="p">(</span><span class="n">search_space</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="n">search_space</span><span class="p">)</span>
<span class="n">factorial_run</span> <span class="o">=</span> <span class="n">factorial</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">n</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Number of arms to generate is derived from the search space.</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">factorial_run</span><span class="o">.</span><span class="n">arms</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>24
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we create a trial including all of these arms, so that we can collect data and evaluate the performance of each.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">trial</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">exp</span><span class="o">.</span><span class="n">new_batch_trial</span><span class="p">()</span>
    <span class="o">.</span><span class="n">add_generator_run</span><span class="p">(</span><span class="n">factorial_run</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default, the weight of each arm in <code>factorial_run</code> will be 1. However, to optimize for power on the contrasts of <code>k</code> groups against the status quo, the status quo should be <code>sqrt(k)</code> larger than any of the treatment groups. Since we have 24 different arms in our search space, the status quo should be roughly five times larger.</p>
<p>Because the status quo is already present in <code>factorial_run</code> with a weight of 1, we need to add an additional weight of 4.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">trial</span><span class="o">.</span><span class="n">reweight_status_quo</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">arm_weights</span><span class="p">[</span><span class="n">trial</span><span class="o">.</span><span class="n">status_quo</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5.0
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5.-Iterate-using-Thompson-Sampling">5. Iterate using Thompson Sampling<a class="anchor-link" href="#5.-Iterate-using-Thompson-Sampling">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><markdowncell>
Next, we run multiple trials (iterations of the experiment) to hone in on the optimal arm(s).</markdowncell></p>
<p>In each iteration, we first collect data about all arms in that trial by calling <code>exp.eval_trial()</code>. Then we run Thompson Sampling, which assigns a weight to each arm that is proportional to the probability of that arm being the best. Arms whose weight exceed <code>min_weight</code> are added to the next trial, so that we can gather more data on their performance.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Running iteration </span><span class="si">{}</span><span class="s2">..."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">eval_trial</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
    <span class="n">thompson</span> <span class="o">=</span> <span class="n">Models</span><span class="o">.</span><span class="n">THOMPSON</span><span class="p">(</span>
        <span class="n">experiment</span><span class="o">=</span><span class="n">exp</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">min_weight</span><span class="o">=</span><span class="mf">0.01</span>
    <span class="p">)</span>
    <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thompson</span><span class="p">)</span>
    <span class="n">thompson_run</span> <span class="o">=</span> <span class="n">thompson</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">n</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">trial</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">new_batch_trial</span><span class="p">()</span><span class="o">.</span><span class="n">add_generator_run</span><span class="p">(</span><span class="n">thompson_run</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Running iteration 1...
Running iteration 2...
Running iteration 3...
Running iteration 4...
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot-1:-Predicted-outcomes-for-each-arm-in-initial-trial">Plot 1: Predicted outcomes for each arm in initial trial<a class="anchor-link" href="#Plot-1:-Predicted-outcomes-for-each-arm-in-initial-trial">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><markdowncell>
The plot below shows the mean and standard error for each arm in the first trial. We can see that the standard error for the status quo is the smallest, since this arm was assigned 5x weight.</markdowncell></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">render</span><span class="p">(</span><span class="n">plot_fitted</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">metric</span><span class="o">=</span><span class="s2">"success_metric"</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<div class="plotly-graph-div" id="29640b96d7464a84b3e9a70a8e5de13c" style="width: 100%;"></div><script type="text/javascript">/*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

require(['plotly'], function(Plotly) {
  window.PLOTLYENV = window.PLOTLYENV || {};
  window.PLOTLYENV.BASE_URL = 'https://plot.ly';
  /*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

Plotly.newPlot(
  "29640b96d7464a84b3e9a70a8e5de13c",
  [{"error_y": {"array": [0.05116815275586078, 0.05026513503957238, 0.048142206010830156, 0.04873346958048883, 0.05142612052177897, 0.048758244421111666, 0.047701351086419055, 0.05185842715954775, 0.05019784893839167, 0.04657722880249345, 0.04764154953541278, 0.04946700253742993, 0.04806206969123495, 0.04886680057880445, 0.047313685257262234, 0.046502933009181464, 0.05354697021777517, 0.05242346619792724, 0.050769765419289035, 0.0483463367136878, 0.05023951649347526, 0.05059412769423745, 0.04974337496649377, 0.022949587913487293], "color": "rgba(128,177,211,0.4)", "type": "data"}, "hoverinfo": "text", "legendgroup": "In-sample", "marker": {"color": "rgba(128,177,211,1)"}, "mode": "markers", "name": "In-sample", "showlegend": true, "text": ["<b>Arm 0_0</b><br><br>success_metric: 0.574 [0.523, 0.625]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level21<br>factor3: level32", "<b>Arm 0_1</b><br><br>success_metric: 0.645 [0.594, 0.695]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level21<br>factor3: level33", "<b>Arm 0_10</b><br><br>success_metric: 0.658 [0.610, 0.706]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level21<br>factor3: level34", "<b>Arm 0_11</b><br><br>success_metric: 0.616 [0.567, 0.665]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level22<br>factor3: level31", "<b>Arm 0_12</b><br><br>success_metric: 0.633 [0.582, 0.685]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level22<br>factor3: level32", "<b>Arm 0_13</b><br><br>success_metric: 0.676 [0.627, 0.725]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level22<br>factor3: level33", "<b>Arm 0_14</b><br><br>success_metric: 0.736 [0.689, 0.784]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level22<br>factor3: level34", "<b>Arm 0_15</b><br><br>success_metric: 0.629 [0.577, 0.681]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level21<br>factor3: level31", "<b>Arm 0_16</b><br><br>success_metric: 0.637 [0.587, 0.688]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level21<br>factor3: level32", "<b>Arm 0_17</b><br><br>success_metric: 0.668 [0.621, 0.714]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level21<br>factor3: level33", "<b>Arm 0_18</b><br><br>success_metric: 0.654 [0.606, 0.701]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level21<br>factor3: level34", "<b>Arm 0_19</b><br><br>success_metric: 0.641 [0.591, 0.690]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level22<br>factor3: level31", "<b>Arm 0_2</b><br><br>success_metric: 0.644 [0.596, 0.692]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level21<br>factor3: level34", "<b>Arm 0_20</b><br><br>success_metric: 0.669 [0.621, 0.718]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level22<br>factor3: level32", "<b>Arm 0_21</b><br><br>success_metric: 0.703 [0.655, 0.750]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level22<br>factor3: level33", "<b>Arm 0_22</b><br><br>success_metric: 0.709 [0.663, 0.756]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level22<br>factor3: level34", "<b>Arm 0_3</b><br><br>success_metric: 0.578 [0.524, 0.632]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level22<br>factor3: level31", "<b>Arm 0_4</b><br><br>success_metric: 0.616 [0.564, 0.669]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level22<br>factor3: level32", "<b>Arm 0_5</b><br><br>success_metric: 0.652 [0.601, 0.703]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level22<br>factor3: level33", "<b>Arm 0_6</b><br><br>success_metric: 0.696 [0.648, 0.745]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level22<br>factor3: level34", "<b>Arm 0_7</b><br><br>success_metric: 0.518 [0.468, 0.569]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level21<br>factor3: level31", "<b>Arm 0_8</b><br><br>success_metric: 0.643 [0.593, 0.694]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level21<br>factor3: level32", "<b>Arm 0_9</b><br><br>success_metric: 0.636 [0.586, 0.686]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level21<br>factor3: level33", "<b>Arm status_quo</b><br><br>success_metric: 0.566 [0.543, 0.589]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level21<br>factor3: level31"], "visible": true, "x": ["0_0", "0_1", "0_10", "0_11", "0_12", "0_13", "0_14", "0_15", "0_16", "0_17", "0_18", "0_19", "0_2", "0_20", "0_21", "0_22", "0_3", "0_4", "0_5", "0_6", "0_7", "0_8", "0_9", "status_quo"], "y": [0.5738161559888579, 0.6446991404011462, 0.6577540106951871, 0.6161879895561357, 0.6331360946745562, 0.676056338028169, 0.7363636363636363, 0.6287425149700598, 0.6373937677053825, 0.6675126903553299, 0.6536458333333334, 0.6408839779005525, 0.643979057591623, 0.6694677871148459, 0.7027777777777777, 0.7092391304347826, 0.5779816513761468, 0.6163141993957704, 0.6519174041297935, 0.6962750716332379, 0.5184210526315789, 0.6434782608695652, 0.6361111111111111, 0.5658482142857143], "type": "scatter", "uid": "df2e2214-33ab-47ca-b5c2-ac01d36da1d0"}],
  {"annotations": [{"showarrow": false, "text": "Sort By", "x": 1.18, "xref": "paper", "y": 0.72, "yanchor": "middle", "yref": "paper"}], "font": {"size": 10}, "hovermode": "closest", "title": {"text": "Predicted Outcomes"}, "updatemenus": [{"buttons": [{"args": [{"xaxis.categoryorder": "array", "xaxis.categoryarray": ["status_quo", "0_0", "0_1", "0_2", "0_3", "0_4", "0_5", "0_6", "0_7", "0_8", "0_9", "0_10", "0_11", "0_12", "0_13", "0_14", "0_15", "0_16", "0_17", "0_18", "0_19", "0_20", "0_21", "0_22"]}], "label": "Name", "method": "relayout"}, {"args": [{"xaxis.categoryorder": "array", "xaxis.categoryarray": ["0_7", "status_quo", "0_0", "0_3", "0_11", "0_4", "0_15", "0_12", "0_9", "0_16", "0_19", "0_8", "0_2", "0_1", "0_5", "0_18", "0_10", "0_17", "0_20", "0_13", "0_6", "0_21", "0_22", "0_14"]}], "label": "Effect Size", "method": "relayout"}], "x": 1.25, "xanchor": "left", "y": 0.67, "yanchor": "middle"}], "xaxis": {"categoryarray": ["status_quo", "0_0", "0_1", "0_2", "0_3", "0_4", "0_5", "0_6", "0_7", "0_8", "0_9", "0_10", "0_11", "0_12", "0_13", "0_14", "0_15", "0_16", "0_17", "0_18", "0_19", "0_20", "0_21", "0_22"], "categoryorder": "array", "tickangle": 45}, "yaxis": {"title": {"text": "success_metric"}, "zerolinecolor": "red"}},
  {"showLink": false}
);
});</script>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot-2:-Predicted-outcomes-for-arms-in-last-trial">Plot 2: Predicted outcomes for arms in last trial<a class="anchor-link" href="#Plot-2:-Predicted-outcomes-for-arms-in-last-trial">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following plot below shows the mean and standard error for each arm that made it to the last trial (as well as the status quo, which appears throughout).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">render</span><span class="p">(</span><span class="n">plot_fitted</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">metric</span><span class="o">=</span><span class="s2">"success_metric"</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<div class="plotly-graph-div" id="e9f88a16f19842f48789732813629613" style="width: 100%;"></div><script type="text/javascript">/*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

require(['plotly'], function(Plotly) {
  window.PLOTLYENV = window.PLOTLYENV || {};
  window.PLOTLYENV.BASE_URL = 'https://plot.ly';
  /*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

Plotly.newPlot(
  "e9f88a16f19842f48789732813629613",
  [{"error_y": {"array": [0.04982843382286636, 0.01125317437309093, 0.016892821769305743], "color": "rgba(128,177,211,0.4)", "type": "data"}, "hoverinfo": "text", "legendgroup": "In-sample", "marker": {"color": "rgba(128,177,211,1)"}, "mode": "markers", "name": "In-sample", "showlegend": true, "text": ["<b>Arm 0_13</b><br><br>success_metric: 0.694 [0.644, 0.744]<br><br><em>Parameterization:</em><br>factor1: level12<br>factor2: level22<br>factor3: level33", "<b>Arm 0_22</b><br><br>success_metric: 0.702 [0.691, 0.713]<br><br><em>Parameterization:</em><br>factor1: level13<br>factor2: level22<br>factor3: level34", "<b>Arm status_quo</b><br><br>success_metric: 0.583 [0.567, 0.600]<br><br><em>Parameterization:</em><br>factor1: level11<br>factor2: level21<br>factor3: level31"], "visible": true, "x": ["0_13", "0_22", "status_quo"], "y": [0.693939393939394, 0.702063967228612, 0.5834352078239609], "type": "scatter", "uid": "96af51e2-c6db-4407-89b6-fa22e34c5c38"}],
  {"annotations": [{"showarrow": false, "text": "Sort By", "x": 1.18, "xref": "paper", "y": 0.72, "yanchor": "middle", "yref": "paper"}], "font": {"size": 10}, "hovermode": "closest", "title": {"text": "Predicted Outcomes"}, "updatemenus": [{"buttons": [{"args": [{"xaxis.categoryorder": "array", "xaxis.categoryarray": ["status_quo", "0_13", "0_22"]}], "label": "Name", "method": "relayout"}, {"args": [{"xaxis.categoryorder": "array", "xaxis.categoryarray": ["status_quo", "0_13", "0_22"]}], "label": "Effect Size", "method": "relayout"}], "x": 1.25, "xanchor": "left", "y": 0.67, "yanchor": "middle"}], "xaxis": {"categoryarray": ["status_quo", "0_13", "0_22"], "categoryorder": "array", "tickangle": 45}, "yaxis": {"title": {"text": "success_metric"}, "zerolinecolor": "red"}},
  {"showLink": false}
);
});</script>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><markdowncell>
As expected given our evaluation function, arms with higher levels
perform better and are given higher weight. Below we see the arms
that made it to the final trial.</markdowncell></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">{</span><span class="s2">"values"</span><span class="p">:</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">arm</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="s2">"weight"</span><span class="p">:</span> <span class="n">weight</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">arm</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">trial</span><span class="o">.</span><span class="n">normalized_arm_weights</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>                    values    weight
0  level13,level22,level34  0.416000
1  level12,level22,level33  0.250667
2  level11,level21,level31  0.333333
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot-3:-Rollout-Process">Plot 3: Rollout Process<a class="anchor-link" href="#Plot-3:-Rollout-Process">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also visualize the progression of the experience in the following rollout chart. Each bar represents a trial, and the width of the bands within a bar are proportional to the weight of the arms in that trial.</p>
<p>In the first trial, all arms appear with equal weight, except for the status quo. By the last trial, we have narrowed our focus to only four arms, with arm 0_22 (the arm with the highest levels) having the greatest weight.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ax.plot.bandit_rollout</span> <span class="k">import</span> <span class="n">plot_bandit_rollout</span>
<span class="kn">from</span> <span class="nn">ax.utils.notebook.plotting</span> <span class="k">import</span> <span class="n">render</span>

<span class="n">render</span><span class="p">(</span><span class="n">plot_bandit_rollout</span><span class="p">(</span><span class="n">exp</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<div class="plotly-graph-div" id="3cb5d9cc81274a839d6c6de9f50c1f04" style="width: 100%;"></div><script type="text/javascript">/*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

require(['plotly'], function(Plotly) {
  window.PLOTLYENV = window.PLOTLYENV || {};
  window.PLOTLYENV.BASE_URL = 'https://plot.ly';
  /*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

Plotly.newPlot(
  "3cb5d9cc81274a839d6c6de9f50c1f04",
  [{"hoverinfo": "name+text", "marker": {"color": "rgba(2,63,165,1)"}, "name": "status_quo", "text": ["17.86%", "16.67%", "33.33%", "33.33%", "33.33%"], "width": 0.5, "x": ["Round 0", "Round 1", "Round 2", "Round 3", "Round 4"], "y": [17.857142857142858, 16.666666666666668, 33.33333333333333, 33.333333333333336, 33.333333333333336], "type": "bar", "uid": "3b507fa1-4a5e-45b4-8bbc-a1a7a6eb2806"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(125,135,185,1)"}, "name": "0_0", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "5230bca7-3f9b-428c-b2b8-db0f3a24ff27"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(190,193,212,1)"}, "name": "0_1", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "e6c32013-0a96-4565-9bdc-9b0f130ccd4a"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(214,188,192,1)"}, "name": "0_2", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "aa9dadb7-1212-4fc2-b8ea-dd16b83ccefa"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(187,119,132,1)"}, "name": "0_3", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "3bfb274e-52b0-4078-bc36-e27ade53452c"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(142,6,59,1)"}, "name": "0_4", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "e9083a4c-99bc-4a40-8d00-12d8a4b538f5"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(74,111,227,1)"}, "name": "0_5", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "75ea3ce9-3aa7-4e3b-8d4f-d980d3dc773a"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(133,149,225,1)"}, "name": "0_6", "text": ["3.57%", "5.99%"], "width": 0.5, "x": ["Round 0", "Round 1"], "y": [3.5714285714285716, 5.991840897501276], "type": "bar", "uid": "b8c6444e-0eb6-4b6b-b395-0c21c92ec9a8"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(181,187,227,1)"}, "name": "0_7", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "eb738644-b63e-4516-8806-f1ff413f699c"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(230,175,185,1)"}, "name": "0_8", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "6cd1b635-0a28-4478-84e9-f2cb71311a99"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(224,123,145,1)"}, "name": "0_9", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "4a284990-9985-47cd-af0f-2cd3d5601f64"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(211,63,106,1)"}, "name": "0_10", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "805b633f-d132-4c98-a601-5a2f8241817a"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(17,198,56,1)"}, "name": "0_11", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "76239a66-271b-4ed6-af0d-9ce8565ff254"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(141,213,147,1)"}, "name": "0_12", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "16c885b0-80b3-4ae7-80a4-8030ebf04799"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(198,222,199,1)"}, "name": "0_13", "text": ["3.57%", "1.23%", "8.94%", "3.33%", "25.07%"], "width": 0.5, "x": ["Round 0", "Round 1", "Round 2", "Round 3", "Round 4"], "y": [3.5714285714285716, 1.23236443991161, 8.944166921534645, 3.333333333333334, 25.06666666666667], "type": "bar", "uid": "45bc7b05-152b-44c1-9ed9-4c867ce6b5bf"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(234,211,198,1)"}, "name": "0_14", "text": ["3.57%", "54.44%"], "width": 0.5, "x": ["Round 0", "Round 1"], "y": [3.5714285714285716, 54.436511983681804], "type": "bar", "uid": "bfe20032-d6dd-46b2-bc23-24f71e7ce8e5"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(240,185,141,1)"}, "name": "0_15", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "36e5198c-a3f3-41cf-820c-e2593c11b4bb"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(239,151,8,1)"}, "name": "0_16", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "e411aef7-d4fd-471c-a4b2-dac143f11c82"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(15,207,192,1)"}, "name": "0_17", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "10d7d748-5d44-4fd3-be8a-28f7f7e74a95"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(156,222,214,1)"}, "name": "0_18", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "881803ca-b9d1-4599-a95e-63cc2823ad2a"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(213,234,231,1)"}, "name": "0_19", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "9a745639-ef77-40d8-9561-6b18970f8f42"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(243,225,235,1)"}, "name": "0_20", "text": ["3.57%"], "width": 0.5, "x": ["Round 0"], "y": [3.5714285714285716], "type": "bar", "uid": "fe720834-d6f1-41fb-9e23-8abf717bf79c"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(246,196,225,1)"}, "name": "0_21", "text": ["3.57%", "9.12%"], "width": 0.5, "x": ["Round 0", "Round 1"], "y": [3.5714285714285716, 9.119496855345915], "type": "bar", "uid": "97d1485b-11b5-42c4-a3d6-261fb7829043"}, {"hoverinfo": "name+text", "marker": {"color": "rgba(247,156,212,1)"}, "name": "0_22", "text": ["3.57%", "12.55%", "57.72%", "63.33%", "41.60%"], "width": 0.5, "x": ["Round 0", "Round 1", "Round 2", "Round 3", "Round 4"], "y": [3.5714285714285716, 12.553119156892745, 57.72249974513202, 63.333333333333336, 41.6], "type": "bar", "uid": "5b4411a4-9ed2-4090-96e5-c761f5119148"}],
  {"barmode": "stack", "margin": {"r": 40}, "showlegend": false, "title": {"text": "Rollout Process<br>Bandit Weight Graph"}, "xaxis": {"categoryarray": ["Round 0", "Round 1", "Round 2", "Round 3", "Round 4"], "categoryorder": "array", "title": {"text": "Rounds"}, "zeroline": false}, "yaxis": {"showline": false, "title": {"text": "Percent"}}},
  {"showLink": false}
);
});</script>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot-4:-Marginal-Effects">Plot 4: Marginal Effects<a class="anchor-link" href="#Plot-4:-Marginal-Effects">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can examine which parameter values had the greatest effect on the overall arm value. As we see in the diagram below, arms whose parameters were assigned the lower level values (such as <code>levell1</code>, <code>levell2</code>, <code>level31</code> and <code>level32</code>) performed worse than average, whereas arms with higher levels performed better than average.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ax.plot.marginal_effects</span> <span class="k">import</span> <span class="n">plot_marginal_effects</span>
<span class="n">render</span><span class="p">(</span><span class="n">plot_marginal_effects</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">'success_metric'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<div class="plotly-graph-div" id="156be5438a65417eb741ef2e62a9339b" style="width: 100%;"></div><script type="text/javascript">/*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

require(['plotly'], function(Plotly) {
  window.PLOTLYENV = window.PLOTLYENV || {};
  window.PLOTLYENV.BASE_URL = 'https://plot.ly';
  /*
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 */

Plotly.newPlot(
  "156be5438a65417eb741ef2e62a9339b",
  [{"error_y": {"array": [1.1826220441625777, 1.4058719810276041, 1.3798316975357816], "type": "data"}, "name": "factor1", "x": ["level11", "level12", "level13"], "y": [-4.557084452625962, 1.226832237388479, 5.021852482006574], "type": "bar", "uid": "5e63e0ba-2b7a-4740-86ec-f9dafd3f863c", "xaxis": "x", "yaxis": "y"}, {"error_y": {"array": [1.006565605131085, 1.1476990802033686], "type": "data"}, "name": "factor2", "x": ["level21", "level22"], "y": [-3.652134154545511, 4.748091339802234], "type": "bar", "uid": "25fa2d4f-82a4-4de7-b9af-c9a75eeace9a", "xaxis": "x2", "yaxis": "y"}, {"error_y": {"array": [1.2987912291100352, 1.6683998585324038, 1.6055636236320434, 1.5690397858448453], "type": "data"}, "name": "factor3", "x": ["level31", "level32", "level33", "level34"], "y": [-8.18759742441973, -0.5880403873087278, 4.8406354274030265, 7.846572278566], "type": "bar", "uid": "8a0d65ed-4d59-402c-8b9c-42e3b68ade69", "xaxis": "x3", "yaxis": "y"}],
  {"annotations": [{"font": {"size": 16}, "showarrow": false, "text": "factor1", "x": 0.14444444444444446, "xanchor": "center", "xref": "paper", "y": 1.0, "yanchor": "bottom", "yref": "paper"}, {"font": {"size": 16}, "showarrow": false, "text": "factor2", "x": 0.5, "xanchor": "center", "xref": "paper", "y": 1.0, "yanchor": "bottom", "yref": "paper"}, {"font": {"size": 16}, "showarrow": false, "text": "factor3", "x": 0.8555555555555556, "xanchor": "center", "xref": "paper", "y": 1.0, "yanchor": "bottom", "yref": "paper"}], "xaxis": {"anchor": "y", "domain": [0.0, 0.2888888888888889]}, "yaxis": {"hoverformat": ".3f", "title": {"text": "% better than experiment average"}}, "xaxis2": {"anchor": "free", "domain": [0.35555555555555557, 0.6444444444444445], "position": 0.0}, "xaxis3": {"anchor": "free", "domain": [0.7111111111111111, 1.0], "position": 0.0}, "showlegend": false, "title": {"text": "Marginal Effects by Factor"}},
  {"showLink": false}
);
});</script>
</div>
</div>
</div>
</div>
</div>
</div></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/versions/0.1.5/files/factorial.ipynb" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Jupyter Notebook</a></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/versions/0.1.5/files//factorial.py" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Source Code</a></div><div class="tutorialRuntime"><p>Total runtime of script: 6.66 seconds.</p></div></div></div></div><footer class="nav-footer" id="footer"><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/versions/0.1.5/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 Facebook Inc.</section></footer></div></body></html>